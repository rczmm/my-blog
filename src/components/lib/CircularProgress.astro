---
interface Props {
  percent?: number;
  size?: number;
  strokeWidth?: number;
  showText?: boolean;
  color?: string;
}

const { 
  percent = 75, 
  size = 120, 
  strokeWidth = 10,
  showText = true,
  color = 'var(--color-primary-start)'
} = Astro.props;

const radius = (size / 2) - strokeWidth;
const center = size / 2;
const circumference = 2 * Math.PI * radius;
const offset = circumference - (percent / 100) * circumference;
---

<div class="circular-progress-preview">
  <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}>
    <circle
      class="bg"
      cx={center}
      cy={center}
      r={radius}
      stroke-width={strokeWidth}
    />
    <circle
      class="progress"
      cx={center}
      cy={center}
      r={radius}
      stroke-width={strokeWidth}
      stroke-dasharray={circumference}
      stroke-dashoffset={offset}
      style={{ stroke: color }}
    />
    {showText && (
      <text x={center} y={center} text-anchor="middle" dominant-baseline="middle" class="text">
        {percent}%
      </text>
    )}
  </svg>
</div>

<style>
  .circular-progress-preview {
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
  }

  svg {
    transform: rotate(-90deg);
  }

  circle {
    fill: none;
    stroke-linecap: round;
  }

  .bg {
    stroke: rgba(var(--color-primary-rgb), 0.05);
  }

  .progress {
    filter: drop-shadow(0 0 8px var(--color-primary-start));
    transition: stroke-dashoffset 1s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .text {
    fill: var(--color-text-title);
    font-size: 1.5rem;
    font-weight: 800;
    font-family: var(--font-mono);
    transform: rotate(90deg);
    transform-origin: center;
  }
</style>
