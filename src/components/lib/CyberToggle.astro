---
interface Props {
  label?: string;
  checked?: boolean;
  size?: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  class?: string;
}

const { 
  label = "SYSTEM_CORE", 
  checked = true, 
  size = 'md',
  disabled = false,
  class: className 
} = Astro.props;
---

<div class:list={["cyber-toggle-container", size, { disabled }, className]}>
  {label && <span class="toggle-label">{label}</span>}
  <label class="toggle-wrapper">
    <input type="checkbox" checked={checked} disabled={disabled} />
    <div class="toggle-track">
      <div class="toggle-thumb">
        <div class="thumb-core"></div>
      </div>
      <div class="track-glitch"></div>
    </div>
  </label>
</div>

<style>
  .cyber-toggle-container {
    display: inline-flex;
    align-items: center;
    gap: 1rem;
    font-family: var(--font-mono);
    user-select: none;
  }

  .toggle-label {
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--color-text-title);
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  .toggle-wrapper {
    position: relative;
    cursor: pointer;
    display: block;
  }

  .toggle-wrapper input {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  /* Track Styling */
  .toggle-track {
    position: relative;
    width: 54px;
    height: 28px;
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(var(--color-primary-rgb), 0.3);
    border-radius: 4px;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    overflow: hidden;
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
  }

  .toggle-wrapper input:checked + .toggle-track {
    background: rgba(var(--color-primary-rgb), 0.1);
    border-color: var(--color-primary-start);
    box-shadow: 0 0 15px rgba(var(--color-primary-rgb), 0.2);
  }

  /* Thumb Styling */
  .toggle-thumb {
    position: absolute;
    top: 3px;
    left: 3px;
    width: 20px;
    height: 20px;
    background: #2a2a2a;
    border: 1px solid #444;
    border-radius: 2px;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
  }

  .thumb-core {
    width: 8px;
    height: 8px;
    background: #666;
    border-radius: 1px;
    transition: all 0.3s ease;
  }

  .toggle-wrapper input:checked + .toggle-track .toggle-thumb {
    transform: translateX(26px);
    background: var(--color-primary-start);
    border-color: #fff;
    box-shadow: 0 0 10px var(--color-primary-start);
  }

  .toggle-wrapper input:checked + .toggle-track .thumb-core {
    background: #fff;
    box-shadow: 0 0 5px #fff;
  }

  /* Glitch Effect on Track */
  .track-glitch {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(var(--color-primary-rgb), 0.2), transparent);
    transform: translateX(-100%);
    transition: transform 0.6s ease;
  }

  .toggle-wrapper:hover .track-glitch {
    transform: translateX(100%);
  }

  /* Size Variations */
  .sm .toggle-track { width: 44px; height: 22px; }
  .sm .toggle-thumb { width: 14px; height: 14px; top: 3px; left: 3px; }
  .sm .toggle-wrapper input:checked + .toggle-track .toggle-thumb { transform: translateX(22px); }
  .sm .toggle-label { font-size: 0.7rem; }

  .lg .toggle-track { width: 64px; height: 34px; }
  .lg .toggle-thumb { width: 26px; height: 26px; top: 3px; left: 3px; }
  .lg .toggle-wrapper input:checked + .toggle-track .toggle-thumb { transform: translateX(30px); }
  .lg .toggle-label { font-size: 1rem; }

  /* Disabled State */
  .disabled {
    opacity: 0.5;
    pointer-events: none;
  }
  .disabled .toggle-track {
    border-color: #333;
    background: #111;
  }
</style>